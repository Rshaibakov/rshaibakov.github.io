var app=angular.module("app",["ngRoute","ngCookies","ngMockE2E","n3-pie-chart"]).config(["$routeProvider",function(r){r.when("/",{templateUrl:"partials/pie_chart.html",controller:"MainCtrl"}).when("/signin",{templateUrl:"partials/signin.html",controller:"UserCtrl"}).when("/signup",{templateUrl:"partials/signup.html",controller:"UserCtrl"}).otherwise({redirectTo:"/"})}]).run(["$location","$cookies","$httpBackend","UserService","ChartService",function(r,n,e,o,t){e.whenGET(/\.html$/).passThrough(),e.whenPOST("/auth").respond(function(r,n,e){var t=angular.fromJson(e);return o.findUser(t.login,t.password,!1)?[200,"Ok",{}]:[401,"Unauthorized",{}]}),e.whenPOST("/reg").respond(function(r,n,e){var t=angular.fromJson(e);return o.findUser(t.login,"",!0)?[403,"Forbidden",{}]:(o.addUser(t),[200,"Ok",{}])}),e.whenGET("/chart_data").respond(t.getData()),r.path("true"===n.get("isLogged")?"/":"/signup"==r.path()?"/signup":"/signin")}]);app.controller("UserCtrl",["$scope","$location","$cookies","$http",function(r,n,e,o){var t="/signin"==n.path()?"/auth":"/reg";r.userInput=function(){o.post(t,{login:r.user.login,password:r.user.password}).success(function(){e.put("isLogged",!0),n.path("/")}).error(function(){r.errors=!0})}}]),app.controller("MainCtrl",["$scope","$location","$cookies","$http",function(r,n,e,o){r.options={thickness:90},o.get("/chart_data").success(function(n){r.data=n}),r.signOut=function(){e.put("isLogged",!1),n.path("/signin")}}]),app.factory("UserService",[function(){var r=[{login:"test",password:"test"},{login:"admin",password:"12345"},{login:"simple_user",password:"12345"}];return{getUsers:function(){return r},findUser:function(n,e,o){var t=!1;return angular.forEach(r,function(r){o?t||r.login!=n||(t=!0):t||r.login!=n||r.password!=e||(t=!0)}),t},addUser:function(n){r.push(n)}}}]),app.factory("ChartService",[function(){var r=[{label:"One",value:25,color:"#18BC9C"},{label:"Two",value:75,color:"#e74c3c"},{label:"Three",value:45,color:"#F39C12"},{label:"Four",value:15,color:"#3498DB"}];return{getData:function(){return r}}}]);